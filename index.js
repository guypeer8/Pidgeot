'use strict';function Pidgeot(_ref){var a=_ref.model,_ref$path=_ref.path,b=_ref$path===void 0?'/':_ref$path,_ref$page=_ref.page,c=_ref$page===void 0?1:_ref$page,_ref$query=_ref.query,d=_ref$query===void 0?{}:_ref$query,_ref$factor=_ref.factor,e=_ref$factor===void 0?50:_ref$factor,_ref$sort=_ref.sort,f=_ref$sort===void 0?null:_ref$sort,_ref$fields=_ref.fields,g=_ref$fields===void 0?{}:_ref$fields;if(!a)throw new Error('A mongoose model must be passed.');return this instanceof Pidgeot?void(this.model=a,this.path=b,this.page=c,this.query=d,this.factor=e,this.sort=f,this.fields=g):new Pidgeot({model:a,path:b,page:c,query:d,factor:e,sort:f,fields:g})}Pidgeot.prototype.paginate=function(){var b=this,a=new Promise(function(c,d){b.model.find(b.query).count(function(e,f){if(e)return d(e);var g=Math.ceil(f/b.factor),h=+b.page;h=isNaN(h)||1>h?1:h,h=h>g?g:h,b.page=h;var i=0>=h?0:(h-1)*b.factor,j=1==h?1:h-1,k=h===g?g:h+1,l='';for(var m in b.fields)l+='&'+m+'='+(b.fields[m]||'');var n=b.path+'?page='+j+l,o=b.path+'?page='+k+l,p=b.model.find(b.query);b.sort&&p.sort(b.sort),0<i&&p.skip(i),p.limit(b.factor).lean().exec(function(q,r){return q?d(q):void c({page:h,records:r,prev_page:n,next_page:o,num_records:f,num_pages:g})})})});return a},module.exports=Pidgeot;